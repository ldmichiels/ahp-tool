<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>AHP</title>

		<!-- Bootstrap CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
		<!-- jQuery -->
		<script src="http://code.jquery.com/jquery.js"></script>
		<!-- <script src="https://code.jquery.com/jquery-1.12.3.js"></script> -->
		<!-- Bootstrap JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
		<!-- Data Tables Lib with CDN -->
		<!--
		<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.css">
		<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.js"></script>
		-->
		<style type="text/css" media="screen">
			.show-grid {
				margin-bottom: 15px;
			}

			.highlight {
				background-color: #5CB85C !important; 
			}

			#consistencyFail, #consistencyOk {
				position: fixed;
				top: 15px;
			}
		</style>
		<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.12/r-2.1.0/se-1.2.0/datatables.min.css"/>
		<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.12/r-2.1.0/se-1.2.0/datatables.min.js"></script>
	</head>
	<body>
		<div class="page-header">
		  <h1>AHP<small>Proceso Analítico Jerárquico</small></h1>
		</div>

 		<div role="tabpanel">
 			<!-- Nav tabs -->
 			<ul class="nav nav-tabs" role="tablist">
 				<li role="presentation" class="active">
 					<a href="#home-tab" aria-controls="home" role="tab" data-toggle="tab">Inicio</a>
 				</li>
 				<li role="presentation">
 					<a href="#getstart-tab" aria-controls="getstart" role="tab" data-toggle="tab">Cómo operar</a>
 				</li>
 				<li role="presentation">
 					<a href="#goal-tab" aria-controls="goal" role="tab" data-toggle="tab">Objetivo</a>
 				</li>
 				<li role="presentation">
 					<a href="#criteria-tab" aria-controls="criteria" role="tab" data-toggle="tab">Criterios</a>
 				</li>
 				<li role="presentation">
 					<a href="#alternatives-tab" aria-controls="alternatives" role="tab" data-toggle="tab">Alternativas</a>
 				</li>
 				<li role="presentation">
 					<a href="#process-tab" aria-controls="process" role="tab" data-toggle="tab">Juicios de Criterios</a>
 				</li>
 				<li role="presentation">
 					<a href="#altPriorities-tab" aria-controls="altPriorities" role="tab" data-toggle="tab">Juicios de Alternativas</a>
 				</li>
 				<li role="presentation">
 					<a href="#creditos-tab" aria-controls="creditos" role="tab" data-toggle="tab">Créditos</a>
 				</li>
 			</ul>
 		
 			<!-- Tab panes -->
 			<div class="tab-content">
	 			<div class="container-fluid">
	 				<!-- Deberian crearse dinamicamente (con nombre de tabla ponele) -->
	 				<div class="row">
						<div id="consistencyOk" class="alert alert-success">
							<strong>Pefecto!</strong> La matriz es consistente.
						</div>
					</div>
					<div class="row">
						<div id="consistencyFail" class="alert alert-danger">
							<strong>Alerta!</strong> La matriz es inconsistente.
						</div>
					</div>
	 			</div>
 				<!-- First tab -->
 				<div role="tabpanel" class="tab-pane active" id="home-tab">
 					<div class="jumbotron">
						<div class="container">
							<h1>AHP</h1>
							<p>Proceso Analítico Jerárquico</p>
							<div class="well well-lg">
								<p>
								El Proceso de Jerarquía Analítica (PJA) (a veces también traducido como Proceso Analítico Jerárquico) es una técnica estructurada para tratar con decisiones complejas. En vez de prescribir la decisión «correcta», el PJA ayuda a los tomadores de decisiones a encontrar la solución que mejor se ajusta a sus necesidades y a su compresión del problema.
								</p>
								<p>
								Esta herramienta, basada en matemáticas y psicología, fue desarrollada por Thomas L. Saaty en los setenta y ha sido extensivamente estudiado y refinado, desde entonces. El PJA provee un marco de referencia racional y comprensivo para estructurar un problema de decisión, para representar y cuantificar sus elementos, para relacionar esos elementos a los objetivos generales, y para evaluar alternativas de solución. El PJA es usado alrededor del mundo en una amplia variedad de situaciones de decisión, en campos tales como gobierno, negocios, industria, salud y educación.
								</p>
							</div>
							<a class="btn btn-primary btn-lg" href="https://es.wikipedia.org/wiki/Proceso_Anal%C3%ADtico_Jer%C3%A1rquico">Leer más</a>
						</div>
					</div>
 				</div>
 				<!-- Second tab -->
 				<div role="tabpanel" class="tab-pane" id="getstart-tab">
 					<div class="container-fluid">
 						<div class="row">
 							<p>Descripción del proceso</p>
 							<ol>
 								<li>Definir el objetivo.</li>
 								<li>Cargar las alternativas y bloquear la tabla.</li>
 								<li>Cargar los criterios y boquear la tabla.</li>
 								<li>Cargar los juicios sobre los criterios, subcriterios y alternativas.</li>
 								<li>Ir a la solapa del objetivo y calcular.</li>
 								<li>Las alternativas priorizadas se listarán en una tabla y la mejor opción estará resaltada en verde.</li>
 							</ol>
 						</div>
 						<div class="row">
 							<p>Recomendaciones: </p>
 							<ol>
 								<li>No utilizar demasiadas alternativas y criterios.</li>
 							</ol>
 						</div>
 						<div>
 							<input type="file" id="file" name="file" />
 						</div>
 					</div>
 				</div>
 				<!-- Third tab -->
 				<div role="tabpanel" class="tab-pane" id="goal-tab">
 					
 					<div class="form-group">
 						<label for="input" class="col-sm-2 control-label">Objetivo: </label>
 						<div class="col-sm-10">
 							<input type="text" name="goal" id="inputGoal" class="form-control" value="El objetivo que te propongas..." required="required" pattern="" title="Goal">
 						</div>
 					</div>
 					<button type="button" class="btn btn-lg btn-success" id="calculate">Calcular</button>
	 				<div class="container-fluid">
	 					<div class="row" id="#result">
	 						<table id="resultTable" class="table table-hover">
	 						</table>
	 					</div>
	 				</div>
 				</div>
 				<!-- Fourth tab -->
 				<div role="tabpanel" class="tab-pane" id="criteria-tab">
 					<div class="panel panel-default">
						<div class="container-fluid">
							<div class="row">
								<!-- Default panel contents -->
								<div class="panel-heading">Cargar criterios</div>
								<div class="panel-body">
									<p>Usted debería cargar sus criterios en la siguiente tabla.</p>
									<div class="btn-group" role="group" aria-label="...">
										<!-- Trigger the modal with a button -->
			  							<button type="button" id="modalCriteriaBtn" class="btn btn-default" data-toggle="modal" data-target="#myModalCriteria">Agregar</button>
										<button type="button" id="removeCriteria" class="btn btn-default">Borrar</button>
										<button type="button" id="clearCriteria" class="btn btn-default">Limpiar todo</button>
									</div>
									<button type="button" id="subCriteria" data-toggle="modal" href='#subcriteriaModal' class="btn btn-default">Subcriterios</button>
									<button type="button" id="lockCriteriaTable" class="btn btn-default">Bloquear</button>
								</div>
							</div>
							<div class="row">
								<!-- Table -->
								<table id="criteriaTable" class="table table-hover">
			 						<thead>
			 							<tr>
			 								<th>Id</th>
			 								<th>Nombre</th>
			 								<th>Descripción</th>
			 								<th>Es cuantitativo</th>	
			 							</tr>
			 						</thead>
			 						<tbody>
			 						</tbody>
			 					</table>
							</div>
						</div>
	 				</div>
 				</div>
 				<!-- Fifth tab -->
 				<div role="tabpanel" class="tab-pane" id="alternatives-tab">
 					<div class="panel panel-default">
						<div class="container-fluid">
							<div class="row">
								<!-- Default panel contents -->
								<div class="panel-heading">Cargar alternativas</div>
								<div class="panel-body">
								<p>Usted debería cargar sus alternativas en la siguiente tabla.</p>
								<div class="btn-group" role="group" aria-label="...">
									<!-- Trigger the modal with a button -->
									<button type="button" id="modalAlternativesBtn" class="btn btn-default" data-toggle="modal" data-target="#myModalAlternatives">Agregar</button>
									<button type="button" id="removeAlternative" class="btn btn-default">Borrar</button>
									<button type="button" id="clearAlternatives" class="btn btn-default">Limpiar todo</button>
								</div>
								<button type="button" id="lockAlternativesTable" class="btn btn-default">Bloquear</button>
								</div>
							</div>
							<div class="row">
								<!-- Table -->
								<table id="alternativesTable" class="table table-hover">
									<thead>
										<tr>
											<th>Id</th>
											<th>Nombre</th>
											<th>Descripción</th>
										</tr>
									</thead>
									<tbody>
									</tbody>
								</table> 							
							</div>
						</div>
					</div>
				</div>
 				<!-- Sixth tab -->
 				<div role="tabpanel" class="tab-pane" id="process-tab">
	 				<div class="container-fluid">
	 					<div class="row">
	 						<div class="panel panel-default">
			 					<div class="panel-heading">
			 						<h3 class="panel-title">Criteria Priorities</h3>
			 					</div>
			 					<div class="panel-body">
			 						<p>You need to lock the tables of criteria and then upload your judgments.</p>
			 					</div>
			 				</div>
	 					</div>
		 				<div class="row">
		 					<div class="panel panel-default">
		 						<div class="panel-heading">
		 							<h3 class="panel-title">Criteria Pairwise Comparisons Matrix</h3>
		 						</div>
		 						<div class="panel-body">
		 						</div>
		 					</div>
		 				</div>
	 				</div>
 				</div>
 				<!-- Seventh tab -->
 				<div role="tabpanel" class="tab-pane" id="altPriorities-tab">
 					<div class="container-fluid">
 						<div class="row">
 							<div class="panel panel-default">
			 					<div class="panel-heading">
			 						<h3 class="panel-title">Alternatives Priorities</h3>
			 					</div>
			 					<div class="panel-body">
			 						<p>You need to lock the tables of criteria and alternatives and then upload your judgments.</p>
			 						<p>You must find local priorities betwen alternatives.</p>
			 					</div>
		 					</div>
 						</div>
		 				<div class="row">
		 					<div class="panel panel-default">
		 						<div class="panel-heading">
		 							<h3 class="panel-title">Alternatives Pairwise Comparisons Matrix</h3>
		 						</div>
		 						<div class="panel-body">
		 						</div>
		 					</div>
		 				</div>
 					</div>
 				</div>
 				<!-- Eighth tab -->
 				<div role="tabpanel" class="tab-pane" id="creditos-tab">
 					<div class="container-fluid">
 						<div class="row">
 							<div class="panel panel-default">
			 					<div class="panel-heading">
			 						<h3 class="panel-title">Créditos</h3>
			 					</div>
			 					<div class="panel-body">
			 						<p>Este trabajo fue realizado como trabajo final para las materias de grado Investigación Operativa y la optativa Cuadro de Mando Integral de la carrera de Ingeniería de Sistemas de la <a href="http://www.unicen.edu.ar/" title="UNICEN">Universidad Nacional del Centro de la Provincia de Buenos Aires</a>, a mediados del año 2016.</p>
			 						<p>Autor: Lucas D. Michiels</p>
			 						<p>Profesor: Mg. Daniel Xodo</p>
			 						<p><a href="http://www.exa.unicen.edu.ar/es" title="EXACTAS">Facultad de Ciencias Exactas</a></p>
			 						<p>http://invop.alumnos.exa.unicen.edu.ar/</p>
			 						<p>El proyecto puede ser descargado desde <a href="https://github.com/ldmichiels/ahp-tool">GitHub.</a>
			 					</div>
		 					</div>
 						</div>
 					</div>
 				</div>
 				
 			</div>
 		</div>

 		<!-- Modal SubCriteria -->
 		<div class="modal fade" id="subcriteriaModal">
 			<div class="modal-dialog">
 				<div class="modal-content">
 					<div class="modal-header">
 						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
 						<h4 class="modal-title">Sub-Criterios</h4>
 					</div>
 					<div class="modal-body">
						<div class="btn-group" role="group" aria-label="...">
							<button type="button" id="addSubCriteria" class="btn btn-default">Agregar</button>
							<!--<button type="button" id="removeSubCriteria" class="btn btn-default">Remove</button>-->
							<button type="button" id="clearSubCriteria" class="btn btn-default">Limpiar todo</button>
						</div>
						<h3>Lista de subcriterios</h3>
						<ul id="subCriteriaList" style="list-style-type: none"></ul>
 					</div>
 					<div class="modal-footer">
 						<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
 						<button type="button" id="saveSubcriteria" class="btn btn-primary" data-dismiss="modal">Guardar cambios</button>
 					</div>
 				</div>
 			</div>
 		</div>

 		<!-- Modal Criteria -->
 		<div class="modal fade" id="myModalCriteria">
 			<div class="modal-dialog">
 				<!-- Modal Content -->
 				<div class="modal-content">
 					<div class="modal-header">
 						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
 						<h4 class="modal-title">Nuevo criterio</h4>
 					</div>
 					<div class="modal-body">
	 					<div class="container-fluid">
		 					<div class="row show-grid">
		 						<label for="criteriaName" class="col-sm-2 control-label">Nombre: </label>
		 						<div class="col-sm-10">
		 							<input type="text" name="criteriaName" id="criteriaName" class="form-control" value="Criteria Name" required="required" pattern="" title="Criteria Name">
		 						</div>
		 					</div>
	 						<div class="row show-grid">
		 						<label for="criteriaDescription" class="col-sm-2 control-label">Descripción: </label>
		 						<div class="col-sm-10">
		 							<input type="text" name="criteriaDescription" id="criteriaDescription" class="form-control" value="Criteria Description" required="required" pattern="" title="Criteria Description">
		 						</div>
		 					</div>
		 					<div class="row show-grid">
		 						<div class="col-sm-12 checkbox">
		 							<label>
		 								<input type="checkbox" id="criteriaQuantitative" required="required" pattern="" title="Quantitative Criteria">
		 								Es Cuantitativo
		 							</label>
		 						</div>
		 						
		 					</div>
	 					</div>
	 				</div>
 					<div class="modal-footer">
 						<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
 						<button type="button" id="addCriteria" class="btn btn-succes" data-dismiss="modal">Agregar</button>
 					</div>
 				</div>
 			</div>
 		</div>

 		<!-- Modal Alternatives-->
 		<div class="modal fade" id="myModalAlternatives">
 			<div class="modal-dialog">
 				<!-- Modal Content -->
 				<div class="modal-content">
 					<div class="modal-header">
 						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
 						<h4 class="modal-title">Nueva alternativa</h4>
 					</div>
 					<div class="modal-body">
	 					<div class="container-fluid">
	 						<div class="row show-grid">
		 						<label for="AlternativeName" class="col-sm-2 control-label">Nombre: </label>
		 						<div class="col-sm-10">
		 							<input type="text" name="alternativeName" id="alternativeName" class="form-control" value="Alternative Name" required="required" pattern="" title="Alternative Name">
		 						</div>
		 					</div>
	 						<div class="row show-grid">
		 						<label for="alternativeDescription" class="col-sm-2 control-label">Descripción: </label>
		 						<div class="col-sm-10">
		 							<input type="text" name="alternativeDescription" id="alternativeDescription" class="form-control" value="Alternative Description" required="required" pattern="" title="Alternative Description">
		 						</div>
		 					</div>
	 					</div>
 					</div>
 					<div class="modal-footer">
 						<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
 						<button type="button" id="addAlternative" class="btn btn-succes" data-dismiss="modal">Agregar</button>
 					</div>
 				</div>
 			</div>
 		</div>

 		<!-- Modal Numeric -->
 		<div class="modal fade" id="numericPopup">
 			<div class="modal-dialog">
 				<div class="modal-content">
 					<div class="modal-header">
 						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
 						<h4 class="modal-title">Insert numeric value</h4>
 					</div>
 					<div class="modal-body">
 						<div class="container-fluid">
	 						<div class="row show-grid">
 								<input type="number" name="" id="value" class="form-control" required="required" title="Value">
 							</div>
 						</div>
 					</div>
 					<div class="modal-footer">
 						<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
 						<button type="button" class="btn btn-primary" data-dismiss="modal" id="loadValue">Aceptar</button>
 					</div>
 				</div>
 			</div>
 		</div>

 		<!-- Modal Judgment -->
 		<div class="modal fade" id="judgmentsPopup">
 			<div class="modal-dialog">
 				<div class="modal-content">
 					<div class="modal-header">
 						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
 						<h4 class="modal-title">Juicios</h4>
 					</div>
 					<div class="modal-body">
 						<div class="container-fluid">
	 						<div class="row show-grid">
		 						<table class="table table-condensed table-hover">
		 							<thead>
		 								<tr>
		 									<th>Escala</th>
		 									<th>Valor numérico</th>
		 									<th>Valor reciproco</th>
		 								</tr>
		 							</thead>
		 							<tbody>
		 								<tr>
		 									<td>Extremadamente preferida</td>
		 									<td>9</td>
		 									<td>1/9</td>
		 								</tr>
		 								<tr>
		 									<td>Preferencia entre muy fuerte o demostrada y extremadamente preferida</td>
		 									<td>8</td>
		 									<td>1/8</td>
		 								</tr>
		 								<tr>
		 									<td>Preferencia muy fuerte o demostrada</td>
		 									<td>7</td>
		 									<td>1/7</td>
		 								</tr>
		 								<tr>
		 									<td>Preferencia entre fuerte y muy fuerte o demostrada</td>
		 									<td>6</td>
		 									<td>1/6</td>
		 								</tr>
		 								<tr>
		 									<td>Preferencia fuerte</td>
		 									<td>5</td>
		 									<td>1/5</td>
		 								</tr>
		 								<tr>
		 									<td>Preferencia entre moderada y fuerte</td>
		 									<td>4</td>
		 									<td>1/4</td>
		 								</tr>
		 								<tr>
		 									<td>Preferencia moderada</td>
		 									<td>3</td>
		 									<td>1/3</td>
		 								</tr>
		 								<tr>
		 									<td>Preferencia entre igual y moderada</td>
		 									<td>2</td>
		 									<td>1/2</td>
		 								</tr>
		 								<tr>
		 									<td>Igualmente preferida</td>
		 									<td>1</td>
		 									<td>1</td>
		 								</tr>
		 							</tbody>
		 						</table>
		 					</div>
	 						<div class="row show-grid">
		 						<label for="judgment" class="col-sm-2 control-label">Juicios: </label>
		 						<div class="col-sm-10">
		 							<input type="number" name="judgment" id="judgment" class="form-control" required="required" min="0" max="9" title="Judgment">
		 						</div>
		 					</div>
 						</div>
 					</div>
 					<div class="modal-footer">
 						<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
 						<button type="button" class="btn btn-primary"  data-dismiss="modal" id="loadJudgment">Aceptar</button>
 					</div>
 				</div>
 			</div>
 		</div>

		<script>
 			$(document).ready(function() {

 				function Critery(i,n,d, q) {
 					this.id = i;
 					this.name = n;
 					this.description = d;
 					this.subCriteria = [];
 					this.quantitative = q || false;

 					this.addSubCritery = function (sc) {
 						this.subCriteria.push( sc );
 					};
 					this.clearSubCriteria = function () {
 						this.subCriteria = [];
 					};
 				}

 				function Alternative(i,n,d) {
 					this.id = i;
 					this.name = n;
 					this.description = d;
 				}

 				function Node(tn,vn) {
 					this.tableName = tn;
 					this.vectorName = vn;

 					this.table = null;
 					this.vector = null;
 					this.criteryId = null;
 					this.type = null;
 				}

 				// General
 				/**
 				 * Types for Nodes
 				 * 1.Crit x Crit
 				 * 2.SubC x SubC
 				 * 3.Alt x Crit
 				 * 4.Alt x SubC
 				 */
 				const TYPE_ONE = 1;
 				const TYPE_TWO = 2;
 				const TYPE_THREE = 3;
 				const TYPE_FOUR = 4;

				const LOCK = "Bloquear";
				const UNLOCK = "Desbloquear";
				const CELL_CONTENT_DEFAULT = 'Click para editar!';
				const CLASS_COLUMN8 = "col-xs-8 col-sm-8 col-md-8 col-lg-8";
	 			const CLASS_COLUMN4 = "col-xs-4 col-sm-4 col-md-4 col-lg-4";
				
				var alternatives = [];
				var criteria = [];
				var subcriteria = [];
				var info = [];

				var lastIdx;
				var lastTable;
				var lastVector;
				var lastQuantitative;

				// Hide alert divs (we show it later, when we need it)
				$('#consistencyFail').hide();
				$('#consistencyOk').hide();

				/**
				 * Add Subcriteria
				 */
				var counter = 0;
				var firstTime = true;
				var pos;

				/**
				 * Initial configuration for modal popup
				 */
				$('#subcriteriaModal').on('show.bs.modal', function (event) {
					var data = criteriaTable.rows("[class*='selected']").data().toArray()[0];
					var critery = getElementWithId( data[0], criteria );
					pos = criteria.indexOf( critery );
					firstTime = false;
					for ( idx in critery.subCriteria ) {
						newSubcriteriaItem( critery.subCriteria[idx] );
					}
				});

				$('#subcriteriaModal').on('hide.bs.modal', function (event) {
					var elems = $("ul#subCriteriaList li");
					
					elems.each(function () {
						$( this ).detach();
					});
					$( '#addSubCriteria' ).prop("disabled", false);
				});

				$('#addSubCriteria').on( 'click', function () {
					$( this ).prop("disabled", true);
					newSubcriteriaItem();
				});

				function newSubcriteriaItem( desc ) {
					// optional parameter
					var desc = desc || "";

					var input = $('<input type="text" class="form-control">').val( desc );
					var btn = $('<button type="button" class="btn btn-default" disabled="true">Ok!</button>');
					var span = $('<span class="input-group-btn"></span>').append( btn );
					var div = $('<div class="input-group"></div>').append( input,span );
					var li = $('<li id="subCriteriaName-'+ counter +'"></li>').append( div );
					$("ul#subCriteriaList").append( li );
					
					if (desc != "") {
						btn.text( 'Delete' );
						input.prop("disabled", true);
						counter++;
						$( '#addSubCriteria' ).prop("disabled", false);
					};
					
					$('#subCriteriaName-'+ counter +' div button').on( 'click', function() {
						if ( $(this).text() == 'Ok!') {
							counter++;
							input.prop("disabled", true);
							$(this).text('Delete');
							$( '#addSubCriteria' ).prop("disabled", false);
						} else {
							counter--;
							li.detach();
						}
					});

					$('#subCriteriaName-'+ counter +' div input').on( 'keyup', function () {
						if($(this).val().length !=0)
							//$('.ok').each(function(){ $(this).prop('disabled', false) });
							$( this ).parent().children('span').children('button').prop('disabled', false);
						else
							//$('.ok').each(function(){ $(this).prop('disabled', true) });
							$( this ).parent().children('span').children('button').prop('disabled', true);
					});
				}

				$('#clearSubCriteria').on( 'click', function () {
					$( '#subCriteriaList' ).empty();
					$( '#addSubCriteria' ).prop("disabled", false);
					criteria[pos].clearSubCriteria();
				});

				$('#saveSubcriteria').on( 'click', function () {
					// Reset variables
					firstTime = true;
					counter = 0;
					criteria[pos].clearSubCriteria();
					var elems = $("ul#subCriteriaList li");
					
					elems.each(function () {
						criteria[pos].addSubCritery( $( this ).find('div input').val() );
						$(this).detach();
					});
				});

				/**
				 * Process result matrix to seach the priority vector
				 */
				$('#calculate').on('click', function () {
					var mtx = [];
					var critV = [];
					var mtxSub = [];
					var subcV = [];
					var vectors = [];

					/*
						1. Resolver subcriterios
						2. Armar matriz
						3. Multiplicar Matriz x vector de criterios
					*/
					for (idx in info) {
						var t = $( '#' + info[idx].tableName ).DataTable();
						var v = $( '#' + info[idx].vectorName ).DataTable().data().toArray();
						var c = info[idx].criteryId;
						var s = info[idx].subCriteryId;

						if ( !done(t) ) {
							alert("Faltan cargar criterios!!");
							return false;
						}

						switch ( info[idx].type ) {
							case TYPE_ONE:
								critV = v;
								break;
							case TYPE_TWO:
								subcV[ c ] = v;
								break;
							case TYPE_THREE:
								vectors[ c ] = v;
								break;
							case TYPE_FOUR:
								if (mtxSub[ c ] == null)
									mtxSub[ c ] = [];
								//mtxSub[ c ].push( v );
								mtxSub[ c ][ s ] = v ;
								break;
							default:
								alert("Error calculando!");
								return false;
								break;
						}
					}

					for (idx in mtxSub) {
						vectors[ idx ] = multiplyMatrix( transpose( mtxSub[idx] ), subcV[idx] );
					}

					for (idx in vectors) {
						mtx.push( vectors[idx] );
					}

					mtx = transpose( mtx );

					pVector = multiplyMatrix( mtx, critV );

					var max = 0;
					var dataset = [];

					for (idx in pVector) {
						var row = [];
						row.push( alternatives[ idx ].name );
						row.push( alternatives[ idx ].description );
						row.push( (pVector[ idx ][0] * 100).toFixed(2) );
						dataset.push( row );

						if (pVector[ idx ][0] >= max) {
							max = Number( pVector[ idx ][0] );
						}
					}

					var columns = [
							{ "title": "Alternativa" },
							{ "title": "Descripción" },
							{ "title": "Prioridad (%)" }
						];
					create("resultTable", columns, dataset);
					var nodes = $('#resultTable').DataTable().rows( function (idx, data, node) {
							return Number((max * 100).toFixed(2)) ==  Number(data[2]);
						}).nodes()
						.to$() 
						.addClass( 'highlight' );
				});

 				/**
 				 * Criteria Functionality
 				 */

				$('#lockCriteriaTable').prop("disabled", true);
				$('#modalCriteriaBtn').prop("disabled", true);

				var criteriaTable = $('#criteriaTable').DataTable({
					// Select Extension Enable
					select: {
						style: 'single',//'os',
						sort: false,
						className: 'selected',
						blurable: true
					},
					searching: false,
					paging: false
				});

				$('#addCriteria').on( 'click', function () {
					var id = next( criteria );
					var name = $('#criteriaName').val();
					var desc = $('#criteriaDescription').val();
					var quant = $('#criteriaQuantitative').is(":checked");

					var c = new Critery(id, name, desc, quant);
					addCriteria( c );
				} );

				/**
				 * @param c : Critery
				 */
				function addCriteria( c ) {
					console.log("Adding critery "+c.name);
					criteriaTable.row.add( [
							c.id,
							c.name,
							c.description,
							c.quantitative
						] ).draw( false );
					$('#lockCriteriaTable').prop("disabled", false);
					criteria.push( c );
				}

				$('#removeCriteria').on( 'click', function () {
					var elem = criteriaTable.rows("[class*='selected']").data().toArray()[0];
					criteria.splice( criteria.indexOf( getElementWithId( elem[0], criteria ) ), 1 );
					criteriaTable.rows("[class*='selected']").remove().draw( false );
					
					if (criteriaTable.rows().count() == 0)
						$('#lockCriteriaTable').prop("disabled", true);
				} );

				$('#clearCriteria').on( 'click', function () {
					criteriaTable.clear().draw();
					$('#lockCriteriaTable').prop("disabled", true);
					criteria = [];
				});

				$('#lockCriteriaTable').on( 'click', function () {
					lockCriteriaTable();
				});

				function lockCriteriaTable () {
					var btn = $('#lockCriteriaTable');
					if ( $( btn ).text() == LOCK ) {
						if ( $('#lockAlternativesTable').text() == LOCK ) { 
							alert("No se puede bloquear! Antes debe bloquear las alternativas.");
						}
						else {
							$( btn ).text(UNLOCK);
							$('#modalCriteriaBtn').prop("disabled", true);
							$('#removeCriteria').prop("disabled", true);
							$('#clearCriteria').prop("disabled", true);
							initialize();
						}
					} else {
						$( btn ).text(LOCK);
						$('#modalCriteriaBtn').prop("disabled", false);
						$('#removeCriteria').prop("disabled", false);
						$('#clearCriteria').prop("disabled", false);
						finalize();
					}
				}

				/**
				 * Alternatives Functionality
				 */
				
				$('#lockAlternativesTable').prop("disabled", true);

				var alternativesTable = $('#alternativesTable').DataTable({
					// Select Extension Enable
					select: {
						style: 'os',
						sort: false,
						className: 'selected',
						blurable: true
					},
					searching: false,
					paging: false
				});

				$('#addAlternative').on( 'click', function () {
					var id = next(alternatives);
					var name = $('#alternativeName').val();
					var desc = $('#alternativeDescription').val();

					var alt = new Alternative(id,name,desc);
					addAlternative( alt );
				} );

				/**
				 * @param a : Alternative
				 */
				function addAlternative( a ) {
					alternativesTable.row.add( [
							a.id,
							a.name,
							a.description
						] ).draw( false );

					$('#lockAlternativesTable').prop("disabled", false);
					alternatives.push( a );
				}

				$('#removeAlternative').on( 'click', function () {
					var elem = alternativesTable.rows("[class*='selected']").data().toArray()[0];
					alternatives.splice( alternatives.indexOf( getElementWithId( elem[0], alternatives ) ), 1 );
					alternativesTable.rows("[class*='selected']").remove().draw( false );

					if (alternativesTable.rows().count() == 0)
						$('#lockAlternativesTable').prop("disabled", true);
				} );

				$('#clearAlternatives').on( 'click', function () {
					alternativesTable.clear().draw();
					$('#lockAlternativesTable').prop("disabled", true);
					alternatives = [];
				});

				$('#lockAlternativesTable').on( 'click', function () {
					lockAlternativesTable();
				});

				function lockAlternativesTable () {
					var btn = $('#lockAlternativesTable');
					if ( $( btn ).text() == LOCK ) {
						$( btn ).text(UNLOCK);
						$('#modalAlternativesBtn').prop("disabled", true);
						$('#removeAlternative').prop("disabled", true);
						$('#clearAlternatives').prop("disabled", true);
						$('#modalCriteriaBtn').prop("disabled", false);
					} else {
						if ( $('#lockCriteriaTable').text() == UNLOCK ) { 
							alert("No puede desbloquear! Antes debe desbloquear los criterios.");
						}
						else {
							$( btn ).text(LOCK);
							$('#modalAlternativesBtn').prop("disabled", false);
							$('#removeAlternative').prop("disabled", false);
							$('#clearAlternatives').prop("disabled", false);
							$('#modalCriteriaBtn').prop("disabled", true);
						}
					}
				}

				/**
				 * Criteria Judgments
				 */

				var criPaCoTable;// = $('#criPaCoTable').DataTable();
				var criPaCoCols = [{ "title": "Critery" }];
				var criPaCoData = [];

				/**
				 * Add an element in the 2D specific table as a column and row entry but without content.
				 */
				function addCriteriaToProcessTable( aCritery, index ) {
					console.log("Adding Criteria To Process Table...");
					// add new column (new critery)
					criPaCoCols.push( { "title": aCritery.name } );
					// add new row (new critery)
					var row = new Array( criPaCoCols.length-1 );
					// The first element is the name
					row[0] = aCritery.name;
					
					if (criPaCoCols.length > 2)
						row.fill( CELL_CONTENT_DEFAULT, 1, criPaCoCols.length );

					criPaCoData.push( row );

					// Add new column 
					for ( index in criPaCoData ) {
						criPaCoData[ index ].push( CELL_CONTENT_DEFAULT );
					}

					if ( aCritery.subCriteria.length > 0 ) {
						addSubcriteriaPairwiseComparosonsMatrix( aCritery, index );
					}
				}

				/**
				 * Destroy the specific table.
				 */
				function destroyCriteriaPairwiseComparisonsMatrix() {
					console.log("Deleting Criteria Pairwise Comparisons Matrix...");
					criPaCoTable.destroy();
					$('#criPaCoTable').empty();

					$('#criPVector').DataTable().destroy();
					$('#criPVector').empty();
					
					criPaCoCols = [{ "title": "Critery" }];
					criPaCoData = [];
				}

				/**
				 * Creates the specific table.
				 */
				function createCriteriaPairwiseComparisonsMatrix() {
					criPaCoTable = create('criPaCoTable',criPaCoCols,criPaCoData);
					completeTheDiagonal(criPaCoTable);

					// Create a table of criteria priority vector
					lastVector = create('criPVector',[{ "title": "Priority Vector" }]);

					$('#criPaCoTable').on('click', 'td', function () {
						lastTable = $('#criPaCoTable').DataTable();
						lastIdx = lastTable.cell( this ).index();
						lastVector = $('#criPVector').DataTable();
						enterSaatyValue( this );
					});

					var n = new Node( 'criPaCoTable', 'criPVector' );
					n.type = TYPE_ONE;
					info.push( n );
				}

				function addSubcriteriaPairwiseComparosonsMatrix( aCritery, index ) {
					console.log("Adding Table for subcriteria of the " + aCritery.name);
					var columns = [{ "title": "Subcritery" }];
					for ( idx in aCritery.subCriteria ) {
						columns.push( { "title": aCritery.subCriteria[idx] } );
					}

					var rows = [];
					for (idx in aCritery.subCriteria) {
						// add new row
						var row = new Array( columns.length );
						row[0] = aCritery.subCriteria[idx];
						row.fill(CELL_CONTENT_DEFAULT,1,columns.length);
						rows.push(row);
					}

					var t = "subCriteryComparisonTable-" + index;
					var v = "subCriteryVector-" + index;
					appendTables( aCritery.name,t,v,"process-tab" );

					var table = create(t,columns,rows);
					completeTheDiagonal( table );

					var vector = create(v,[{ "title": "Vector Prioridad" }]);

					$( '#' + t ).on('click', 'td', function() { 
						lastTable = table;
						lastIdx = lastTable.cell( this ).index();
						lastVector = vector;
						enterSaatyValue();
					});

					var n = new Node( t, v );
					n.type = TYPE_TWO;
					n.criteryId = aCritery.id;
					info.push( n );
				}

				/**
				 * Alternatives judgments
				 */

				/**
				 * Crea la tabla de comparación entre alternativas según el criterio dado
				 */
				function addCriteriaTableBtwnAlternatives (critery, subCIdx, index) {
					
					if ( subCIdx == null )
						console.log("Adding Critery Table for " + critery.name);
					else
						console.log("Adding SubCritery Table for " + critery.subCriteria[subCIdx]);

					var t = "comparisonTable-" + index;
					var v = "vector-" + index;
					var title = subCIdx != null ? critery.name + " " + critery.subCriteria[subCIdx] : critery.name;
					appendTables( title, t, v, "altPriorities-tab" );

					var vector = null;

					var columns = [{ "title": "Alternativa" }];
					if ( critery.quantitative ) {
						columns.push( { "title": "Valor" } );
						var rows = [];
						for ( idx in alternatives ) {
							// add new row
							rows.push( [ alternatives[ idx ].name, CELL_CONTENT_DEFAULT ] );
						}

						var table = create( t, columns, rows );
						vector = create( v, [{ "title": "Vector Prioridad" }] );

						$( '#' + t ).on('click', 'td', function() {
							lastTable = table;
							lastIdx = lastTable.cell( this ).index();
							lastVector = vector;
							lastQuantitative = critery.quantitative;
							enterValue();
						});
					}
					else {
						for (idx in alternatives) {
							columns.push( { "title": alternatives[idx].name } );
						}

						var rows = [];
						for ( idx in alternatives ) {
							// add new row
							var row = new Array( columns.length );
							row[0] = alternatives[ idx ].name;
							row.fill( CELL_CONTENT_DEFAULT, 1, columns.length );
							rows.push( row );
						}

						var table = create( t, columns, rows );
						completeTheDiagonal( table );
						vector = create( v, [{ "title": "Vector Prioridad" }] );

						$( '#' + t ).on('click', 'td', function() {
							lastTable = table;
							lastIdx = lastTable.cell( this ).index();
							lastVector = vector;
							lastQuantitative = critery.quantitative;
							enterSaatyValue();
						});
					}

					var n = new Node( t, v );
					if ( subCIdx == null ) {
						n.type = TYPE_THREE;
						n.criteryId = critery.id;
					}
					else {
						n.type = TYPE_FOUR;
						n.criteryId = critery.id;
						n.subCriteryId = subCIdx;
					}
					info.push( n );
				}

				function destroyAlternativeTable () {
					var tables = $("table[id^='comparisonTable-'], table[id^='vector-']").each( function () {
						var id = this.id;
						$( '#'+id ).DataTable().destroy();
					} );
				}


				/**
				 * @param {string} title - 
				 * @param {DataTable.API} idT - Comparision pairwise table
				 * @param {DataTable.API} idV - Vector of priorities
				 * @param {string} tab - 
				 */
				function appendTables (title, idT, idV, tab){
					/**
					<div class="row">
						<h3>Title</h3>
						<div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
							<!-- Pairwise Comparison Table -->
							<table id="idT" class="table table-hover"></table>
						</div>
						<div class="">
							<!-- Vector -->
							<table id="idV" class="table table-hover"></table>
						</div>
					</div>
	 				*/
	 				var row = $('<div></div>').attr("class", "row tables");
	 				var col = $('<div></div>').attr("class", CLASS_COLUMN8);
	 				var table = $('<table></table>').attr("id",idT);
	 				
	 				col.append( table );
	 				row.append( col );
	 				col = $('<div></div>').attr("class", CLASS_COLUMN4);
	 				var table = $('<table></table>').attr("id",idV);
	 				col.append( table );
	 				row.append( col );
	 				row.prepend( '<p>'+title+'</p>');

					$('#'+ tab +' .container-fluid .row:nth-child(2) .panel .panel-body').append( row );
				}

				/**
				 * General Functions
				 */
				function initialize() {
					appendTables("Criteria Pairwise Comparisons Matrix",
							"criPaCoTable",
							"criPVector",
							"process-tab");

					for ( index in criteria ) {
						if ( criteria[ index ].subCriteria.length != 0 ) {
							var subC = criteria[ index ].subCriteria;
							for ( index2 in subC ) {
								addCriteriaTableBtwnAlternatives( criteria[index], index2, index + "-" + index2 );
							}
						}
						else { 
							// Add a table for each critery
							addCriteriaTableBtwnAlternatives( criteria[index], null, index );
						}
						addCriteriaToProcessTable( criteria[index], index );
					}
					createCriteriaPairwiseComparisonsMatrix();
				}

				function finalize() {
					destroyCriteriaPairwiseComparisonsMatrix();
					destroyAlternativeTable();
					$("div.row.tables").has("table[id^='criPaCoTable']").detach();
					$("div.row.tables").has("table[id^='comparisonTable-']").detach();

					info = [];
				}

				/**
				 * @param {string} id - table id
				 * @param {array} cols - columns to set
				 * @param {array} dataset - 2d array, rows of the table
				 */
				function create (id,cols,dataset) {
					var ds = dataset || [];
					return $( '#' + id ).DataTable( {
						searching: false,
						sort: false,
						paging: false,
						data: ds,
						columns: cols,
						destroy: true
					} );
				}

				$('#loadValue').on('click', function() {
					var input = eval($( '#value' ).val());
					// Set the input value
					lastTable.cell(function ( idx, data, node ) {
							return (idx.row == lastIdx.row &&
									idx.column ==  lastIdx.column)
								? true : false;
						}
					).data( input );

					// if all the values has been entered
					if ( done( lastTable ) ) {
						console.log('Done.');
						matrixData = lastTable.columns(function ( idx ) { 
												return idx > 0 ? true : false; 
											} )
											.data().toArray() ;
						var vectorData = normalize( matrixData );
						console.log("Priority vector founded: " + vectorData);

						// Show vector
						lastVector.clear();
						var dataSet = transpose( [ vectorData ] );
						dataSet.forEach( function (item,index,arr) {
									lastVector.row.add( item );
								}
						);
						lastVector.draw();
					} else {
						console.log('Not Done Yet.');
					}
				} );

				$('#loadJudgment').on('click', function() {
					var input = eval($( '#judgment' ).val());
					var reverse = eval(1 / input);
					
					// Set the input value
					lastTable.cell(function ( idx, data, node ) {
							return (idx.row == lastIdx.row &&
									idx.column ==  lastIdx.column)
								? true : false;
						}
					).data( input.toFixed(4) );

					// Set reverse input value
					lastTable.cell(function ( idx, data, node ) {
							return (idx.row == lastIdx.column - 1 &&
									idx.column ==  lastIdx.row + 1)
								? true : false;
						}
					).data( reverse.toFixed(4) );

					// if all the values has been entered
					if ( done( lastTable ) ) {
						console.log('Done.');
						matrixData = lastTable.columns(function ( idx ) { 
												return idx > 0 ? true : false; 
											} )
											.data().toArray() ;
						var vectorData = calculatePriorityVector( matrixData );
						console.log("Priority vector founded: " + vectorData);

						// Show vector
						lastVector.clear();
						var dataSet = transpose( [ vectorData ] );
						dataSet.forEach( function (item,index,arr) {
									lastVector.row.add( item );
								}
						);
						lastVector.draw();

						// Check Consistency of the judgments table
						if ( ! checkConsistency(matrixData, vectorData) ) {
							console.log("Fail! The Consistency Ratio is major than 10%.");
							$('#consistencyFail').delay(200).fadeIn().delay(4000).fadeOut();
						}
						else {
							console.log("Success! The Consistency Ratio is less than 10%.");
							$('#consistencyOk').delay(200).fadeIn().delay(4000).fadeOut();
						}
					} else {
						console.log('Not Done Yet.');
					}
				} );

				function enterSaatyValue(domTable) {
					if (lastIdx.row == lastIdx.column - 1)
						return;
					$('#judgmentsPopup').modal();
				}

				function enterValue() {
					$('#numericPopup').modal();
				}

				/**
				 * Complete the diagonal of the received DataTable with 1.
				 * @param {DataTable.API} 
				 */
				function completeTheDiagonal(table) {
					var selected = table.cells( function ( idx, data, node ) {
							return idx.row == idx.column - 1 ? true : false;
						} ).every(function() { 
							this.data(1);
						});
				}

				/**
				 * Return true if the table doesn't contain a cell with CELL_CONTENT_DEFAULT value.
				 * @param {DataTable.API} table - The table to check
				 * @return {bool} 
				 */
				function done(table) {
					var test = true;
					table.cells( function ( idx, data, node ) {
							if (data == CELL_CONTENT_DEFAULT)
								test &= false;
							} );
					return test;
				}

				/**
				 *
				 *
				 */
				function normalize ( matrix ) {
					console.log(matrix);
					if ( matrix[0].length > 1 )
						console.log("Probablemente necesites calcular el Vector Prioridad en lugar de normalizar,");
					
					matrix = transpose( matrix );
					var sum = 0;
					for ( idx in matrix ) {
						sum += matrix[idx][0];
					}
					var vector = [];
					for ( idx in matrix ) {
						vector.push( matrix[idx][0] / sum );
					}
					return vector;
				}

				/**
				 * Returns the priority vector of the param received.
				 * @param {array} matrix - 2D array (matrix[columns][rows])
				 */
				function calculatePriorityVector ( matrix ) {
					var stdMatrix;

					// Calculating Standard matrix
					stdMatrix = getStandardMatrix( matrix );

					var tM = transpose( stdMatrix );

					var vector = [];
					for ( index in tM ) {
						var row = tM[ index ];
						vector.push( average(row) );
					}
					return vector;
				}

				/**
				 * Multiply two matrix
				 *
				 */
				function multiplyMatrix(A, B) {
					var R = [];
					for (var i = 0; i < A.length; i++) {
						R[i] = [];
						for (var j=0; j< B[0].length; j++) {
							sum = 0;
							for (var k=0; k< B.length; k++) {
								sum += A[i][k] * B[k][j];
							}
						R[i][j] = sum;
				        }
					}
					return R;
				}

				/**
				 * Returns the transpose matrix of the param received.
				 * @param {array} matrix - 2d array (matrix[columns][rows])
				 * @return {array} 2d array
				 */
				function transpose ( m ) {
					var t = [];
					for (c in m) {
						for (r in m[c]) {
							if ( ! Array.isArray( t[r] ) )
								t[r] = [];
							t[r][c] = m[c][r];
						}
					}
					return t;
				}

				/**
				 * Returns the average of an array.
				 * @param {array} matrix 
				 * @return {float}
				 */
				function average ( anArray ) {
					return anArray.reduce(	function (total, num, idx, arr) {
						var aux;
						aux = total + num;
						if (idx == arr.length -1)
						    aux = aux / arr.length;
						return aux;
						}, 0);
				}

				/**
				 * Returns the summation vector of the columns of the param received.
				 * @param {array} matrix - 2D array (matrix[columns][rows])
				 */
				function sumOfColumns ( matrix ) {
					var vector = [];
					for (c in matrix) {
						vector[c] = matrix[c].reduce( function (a,b) {
										return Number(a) + Number(b);
									}, 0 );
					}
					return vector;
				}

				/**
				 * Returns the normalized matrix of the param received.
				 * @param {array} matrix - 2d array (matrix[columns][rows])
				 */
				function getStandardMatrix ( matrix ) {
					var stdM = [];
					// Calculating sum of columns
					var sumVector = sumOfColumns( matrix );

					for (c in matrix) {
						if ( ! Array.isArray( stdM[ c ] ) ) 
								stdM[ c ] = [];
						for (r in matrix[c]) {
							stdM[c][r] =  matrix[c][r] / sumVector[c];
						}
					}
					return stdM;
				}

				/**
				 * Returns true if the Consistency Ratio is less than 10%.
				 * @param {array} matrix - 2d array (matrix[columns][rows])
				 * @return {bool}
				 */
				function checkConsistency (matrix, pVector) {
					var lambdaMax = 0;
					var sumVector = sumOfColumns(matrix);

					for (idx in pVector) {
						lambdaMax += pVector[idx] * sumVector[idx];
					}
					var n = pVector.length;
					var ci = ( lambdaMax - n ) / ( n - 1 );
					var ri = rndIdx( n );
					var cr = ci / ri;
					return cr < 0.1;
				}
				
				/**
				 * Returns the next available id number
				 * @param {array} arr - Array of Critery objects
				 */
				function next (arr) {
					var i = -1;
					for (e in arr) {
						if (arr[e].id > i)
							i = arr[e].id;
					}
					return i+1;
				}

				/**
				 * Retorna el (1er) elemento con el id del paramtro
				 * @param {integer} id
				 * @param {array} arr - Array of Critery/Alternative objects
				 */
				function getElementWithId( id, arr ) {
					for (e in arr)
						if (arr[e].id == id)
							return arr[e];
					return null;
				}

				/**
				 * Returns the Random Index for 'n' dimension.
				 * @param {integer} n - Dimension of the analyzed table
				 */
				function rndIdx (n) {
					switch(n) {
						case 1: return	0.000; break;
						case 2: return	0.000; break;
						case 3: return	0.525; break;
						case 4: return	0.882; break;
						case 5: return	1.115; break;
						case 6: return	1.252; break;
						case 7: return	1.341; break;
						case 8: return	1.404; break;
						case 9: return	1.452; break;
						case 10: return	1.484; break;
						case 11: return	1.513; break;
						case 12: return	1.535; break;
						case 13: return	1.555; break;
						case 14: return	1.570; break;
						case 15: return	1.583; break;
						case 16: return	1.595; break;
						default: return 1.6; break;
 					}
 				}

 				$('#file').on( 'change', function ( evt ) {
 					$( '#file' ).prop("disabled", true);
 					var file = evt.target.files[0];
 					console.log( "load File " + file.name);
					var reader = new FileReader();

					reader.onload = function( e ) {
						console.log( "Reading File "+file.name);
						var text = reader.result;
						loadJSON( text );
					}
					// Read in the image file as a data URL.
					reader.readAsText(file);
				} );

				function setGoal( goal ) {
					$("#inputGoal").val( goal );
				}

 				function loadJSON ( json ) {
 					console.log( "Load Json File");
 					var info = JSON.parse( json );
 					console.log( info );
 					var goal = info.goal; // String
 					var alternatives = info.alternatives; // Array
 					var criteria = info.criteria; // Array

 					setGoal( goal );

 					for ( idx  in alternatives ) {
 						var i = alternatives[idx].id;
 						var n = alternatives[idx].name;
 						var d = alternatives[idx].description;

 						var a = new Alternative( i,n,d );
 						addAlternative( a );
 					}
 					lockAlternativesTable();

 					for ( idx  in criteria ) {
 						var i = criteria[idx].id;
 						var n = criteria[idx].name;
 						var d = criteria[idx].description;
 						var q = criteria[idx].quantitative;

 						var c = new Critery( i,n,d,q );
 						var sc = criteria[idx].subcriteria;
 						for (i in sc) {
 							c.addSubCritery( sc[i] );
 						}
 						addCriteria( c );
 					}
 					lockCriteriaTable();
 					/**
 					setTimeout(null, 200);
 					*/
 				}

			} );
 		</script>
	</body>
</html>